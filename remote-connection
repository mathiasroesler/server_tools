#!/bin/bash

source server_functions

function print_usage() {
	printf "Usage: remote-connection [-h] [-p number] server \n" 
	printf "Connects to a remote server using ssh. The available servers"
	printf " are:\n"
	available_servers
	printf "Options:\n"
	printf " -h, print help.\n"
	printf " -p number, specify port number.\n"

return 0
}


PORT=false
port_number=22

# Parse options
while getopts ":hp:" opt; do
	case $opt in
		h) 
			print_usage
			exit 
			;;
		P)
			port_number="${OPTARG}"
			PORT=true
		       	;;

		?)
			echo "remote-connection: invalid option."
			echo "Try 'remote-connection -h' for help."
			exit
			;;
	esac
done

# Shift to first argument after options.
shift $(($OPTIND - 1))

if [[ $# -lt 1 ]]; then
	echo "remote-connection: not enough arguments."
	echo "Try 'remote-connection -h' for help."
	exit
fi

server_selection $1

print_info
ssh -p $port_number $options $server 
